ported over from https://nexus0.net/pub/sw/lmstui/
